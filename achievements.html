---
title: TEST
---

<html>
<head>
  <title>Your achievements</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
  <script src="https://unpkg.com/frappe-charts@0.0.7/dist/frappe-charts.min.iife.js"></script>
  <script>
"use strict";
/*global XMLHttpRequest, Handlebars, Chart */
function callAjax(url, callback) {
  var xmlhttp;
  // compatible with IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp = new XMLHttpRequest();
  xmlhttp.onreadystatechange = function() {
    if(xmlhttp.readyState === 4 && xmlhttp.status === 200) {
      callback(JSON.parse(xmlhttp.responseText));
    }
  };
  xmlhttp.open("GET", url, true);
  xmlhttp.send();
}
  </script>
  <style>
p.fact {
  border: 1px solid black;
  background: #a09b8c;
  margin: 10px;
  padding: 30px;
}
  </style>
</head>
<body>
  <h1>Your League achievements for Season 7</h1>

  <div id="content"></div>

  <script id="template" type="text/x-handlebars-template">
{% include achievements.html %}
  </script>
  <script>

var graphCounter = 0;
var graphLoader = [];

Handlebars.registerHelper('graph', function(type, title, labelName, dataName, tooltip, data) {
  var graphData = {
    labels: data.map(d => d[labelName]),
    datasets: [{values: data.map(d => d[dataName])}]
  };
  var graphId = "graph-" + graphCounter;
  graphCounter += 1;
  graphLoader.push(function() {
    var chart = new Chart({
      parent: "#" + graphId,
      title: title,
      data: graphData,
      type: type,
      height: 250,

      colors: ['#7cd6fd', '#743ee2'],

      format_tooltip_x: d => (d + '').toUpperCase(),
      format_tooltip_y: d => d + ' ' + tooltip
    });
    chart;
  });

  return new Handlebars.SafeString("<div id=" + graphId + "></div>");
});

var PLATFORMS = {
  'br': 'BR1',
  'eune': 'EUN1',
  'euw': 'EUW1',
  'kr': 'KR',
  'lan': 'LA1',
  'las': 'LA2',
  'na': 'NA1',
  'oce': 'OC1',
  'tr': 'TR1',
  'ru': 'RU',
  'jp': 'JP1',
  'pbe': 'PBE'
};

Handlebars.registerHelper('match_link', function(region, id, accountId) {
  return `https://matchhistory.${region.trim()}.leagueoflegends.com/en/#match-details/${PLATFORMS[region.trim().toLowerCase()]}/${id}/${accountId}?tab=overview`;
});

Handlebars.registerHelper('number', function(number) {
  return number.toLocaleString();
});

Handlebars.registerHelper('duration', function(duration) {
  var hour = Math.floor(duration / 3600);
  var minutes = Math.floor((duration - hour * 3600) / 60);
  var seconds = duration % 60;

  if(hour === 0) {
    return `${minutes}m${seconds}s`;
  }

  return `${hour}h${minutes}m${seconds}s`;
});

Handlebars.registerHelper('table', function(columns, data) {
  columns = columns.split(",");
  var table = "<table><thead><tr>";
  columns.forEach(c => table += `<th>${c.replace('_', ' ')}</th>`);
  table += "</tr></thead><toby>";
  data.forEach(function(d) {
    table += "<tr>";
    columns.forEach(c => table += `<td>${d[c]}</td>`);
    table += "</tr>";
  });
  table += "</table>";
  return new Handlebars.SafeString(table);
});

var source   = document.getElementById("template").innerHTML;
var template = Handlebars.compile(source);
callAjax('http://localhost:3000/achievements?summoner=neamar&region=euw&role=top&level=3', function(res) {
  var html = template(res);
  document.getElementById('content').innerHTML = html;

  setTimeout(function() {
    graphLoader.forEach(f => f());
  }, 10);
});
  </script>
</body>
</html>
